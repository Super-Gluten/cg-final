# 概述
本项目强制要求所有文件使用 **UTF-8 编码**（禁止 GBK/GB2312/GB18030 等编码格式），目的是避免中文乱码、编译异常、Git 协作冲突等问题。本文档将详细说明编码问题的预防方案、批量转换工具使用方法，以及手动修复方案。

# 一、 事前预防：IDE 默认编码配置
优先通过配置 IDE 全局默认编码为 UTF-8，从根源上避免产生 GBK 编码文件，以下是项目兼容 IDE 的配置步骤：

## 1. VSCode 配置（永久生效）
1.  打开 VSCode，点击左侧「设置」（快捷键 `Ctrl + ,`）
2.  在搜索框中输入 `files.encoding`，将对应值修改为 `utf8`
3.  继续搜索 `files.autoGuessEncoding`，将对应值勾选为 `true`（自动识别文件编码，避免打开文件时默认使用 GBK）
4.  可选配置：搜索 `files.defaultLanguage`，确保默认文件编码关联 UTF-8

## 2. Visual Studio 配置（永久生效）
1.  打开 Visual Studio，点击顶部菜单栏「工具」->「选项」
2.  在弹出窗口中，展开「文本编辑器」->「所有语言」->「高级」
3.  下拉找到「默认编码」选项，选择「UTF-8」（推荐「Unicode (UTF-8 无签名)」）
4.  点击「确定」保存配置，后续新建文件将默认使用 UTF-8 编码

# 二、 事后修复：GBK 转 UTF-8 批量工具使用
项目 `tools/` 目录下已提供 `gbk_to_utf8.py` 脚本，支持批量将 GBK 编码文件转换为 UTF-8 编码，无需手动逐个修改。

## 1. 前置条件
确保你的电脑已安装 **Python 3.x 环境**（可通过 `python --version` 或 `python3 --version` 在终端验证是否安装）。

## 2. 工具位置
```
项目根目录/tools/gbk_to_utf8.py
```

## 3. 使用方法
### 基本命令格式
在项目根目录打开终端（CMD/PowerShell/Git Bash），执行以下命令：
```bash
python tools/gbk_to_utf8.py <目标路径>
```

### 两种使用场景（示例）
#### 场景 1：转换单个文件
若仅需转换某个 GBK 编码的源代码文件（如 `src/main.cpp`），命令如下：
```bash
# Windows/Mac/Linux 通用
python tools/gbk_to_utf8.py src/main.cpp
```

#### 场景 2：转换整个目录（批量处理）
若需转换某个目录下所有 GBK 编码文件（如 `src/` 目录下所有 .cpp/.h 文件），直接指定目录路径即可，脚本会递归遍历目录内所有文件：
```bash
# 转换 src 目录下所有文件
python tools/gbk_to_utf8.py src/

# 转换项目根目录下所有文件（谨慎使用，建议优先指定具体目录）
python tools/gbk_to_utf8.py ./
```

## 4. 工具使用注意事项
1.  转换前建议备份目标文件/目录（避免特殊情况导致文件损坏）
2.  若终端提示「找不到文件」，请确认：
    - 终端当前路径为项目根目录（可通过 `cd 项目根目录路径` 切换）
    - 目标路径填写正确（相对路径/绝对路径均可）
3.  脚本仅处理头文件和.cpp代码（.cpp/和.h/），不处理二进制文件
4.  转换完成后，脚本会在终端输出转换成功的文件信息

# 三、 手动转换方式（无 Python 环境备用方案）
若未安装 Python 环境，可通过 IDE 手动转换单个文件编码，步骤如下：

## 1. VSCode 手动转换
1.  用 VSCode 打开目标 GBK 编码文件
2.  观察 VSCode 窗口右下角，会显示当前文件编码（如「GBK」）
3.  点击右下角编码名称，在弹出的菜单中选择「通过编码保存」
4.  在编码列表中找到并选择「UTF-8」，保存后即可完成转换

## 2. Visual Studio 手动转换
1.  用 Visual Studio 打开目标 GBK 编码文件
2.  右键点击该文件（解决方案资源管理器中），选择「高级保存选项」
3.  在弹出窗口中，「编码」下拉框选择「Unicode (UTF-8 无签名)」
4.  点击「确定」，文件将以 UTF-8 编码重新保存

# 四、 常见问题排查
1.  **脚本运行报错：`No module named xxx`**
    - 原因：Python 环境缺少依赖（本脚本无额外依赖，大概率是 Python 未正确安装）
    - 解决：重新安装 Python，并勾选「Add Python to PATH」选项

2.  **转换后文件中文仍乱码**
    - 原因 1：原文件并非 GBK 编码（脚本仅支持 GBK 转 UTF-8）
    - 原因 2：转换后 IDE 仍以 GBK 编码打开文件
    - 解决：先通过 IDE 确认原文件编码，再重新转换；同时检查 IDE 默认编码配置

3.  **Git 提交后显示文件全部内容变更**
    - 原因：文件编码不一致（本地为 GBK，远端为 UTF-8 或反之）
    - 解决：使用本工具批量转换本地文件为 UTF-8，再重新提交